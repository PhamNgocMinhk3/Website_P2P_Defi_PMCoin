<div class="settings-container">
  <!-- Header -->
  <div class="settings-header">
    <h1 class="page-title">
      <span class="title-icon">‚öôÔ∏è</span>
      C√†i ƒê·∫∑t
    </h1>
    <p class="page-subtitle">Qu·∫£n l√Ω t√†i kho·∫£n v√† t√πy ch·ªânh ·ª©ng d·ª•ng</p>
  </div>

  <!-- Success/Error Messages -->
  <div *ngIf="successMessage" class="alert alert-success">
    {{ successMessage }}
  </div>
  <div *ngIf="errorMessage" class="alert alert-error">
    {{ errorMessage }}
  </div>

  <div class="settings-interface">
    <!-- Tab Navigation -->
    <div class="tab-navigation">
      <button class="tab-button" [class.active]="activeTab === 'profile'" (click)="setActiveTab('profile')">
        <span class="tab-icon">üë§</span>
        <span class="tab-text">H·ªì S∆°</span>
      </button>
      <button class="tab-button" [class.active]="activeTab === 'security'" (click)="setActiveTab('security')">
        <span class="tab-icon">üîí</span>
        <span class="tab-text">B·∫£o M·∫≠t</span>
      </button>
      <button class="tab-button" [class.active]="activeTab === 'notifications'" (click)="setActiveTab('notifications')">
        <span class="tab-icon">üîî</span>
        <span class="tab-text">Th√¥ng B√°o</span>
      </button>
    </div>

    <!-- Tab Content -->
    <div class="tab-content">
      <!-- Profile Tab -->
      <div *ngIf="activeTab === 'profile'" class="profile-tab">
        <div class="profile-section">
          <h3 class="section-title">Th√¥ng Tin C√° Nh√¢n</h3>

          <div class="profile-form">
            <!-- Avatar Management -->
            <app-avatar-management [currentAvatar]="userProfile.avatar" (avatarChanged)="onAvatarChanged($event)">
            </app-avatar-management>

            <!-- Form Fields -->
            <div class="form-grid">
              <div class="form-group">
                <label>Email</label>
                <input type="email" [(ngModel)]="userProfile.email" readonly class="form-input readonly-field">
                <small class="field-note">Kh√¥ng th·ªÉ thay ƒë·ªïi</small>
              </div>

              <div class="form-group">
                <label>H·ªç v√† t√™n</label>
                <input type="text" [(ngModel)]="userProfile.fullName" readonly class="form-input readonly-field">
                <small class="field-note">Kh√¥ng th·ªÉ thay ƒë·ªïi</small>
              </div>

              <div class="form-group">
                <label>S·ªë ƒëi·ªán tho·∫°i</label>
                <input type="tel" [(ngModel)]="userProfile.phone" [readonly]="!isEditingProfile" class="form-input">
              </div>

              <div class="form-group">
                <label>M√£ V√≠ ƒëi·ªán t·ª≠</label>
                <textarea [(ngModel)]="userProfile.walletCode" [readonly]="!isEditingProfile" class="form-textarea"
                  rows="3"></textarea>
              </div>
            </div>

            <!-- Action Buttons -->
            <div class="form-actions">
              <button *ngIf="!isEditingProfile" class="btn-primary" (click)="toggleEditProfile()">
                Ch·ªânh S·ª≠a
              </button>

              <div *ngIf="isEditingProfile" class="edit-actions">
                <button class="btn-secondary" (click)="cancelEditProfile()">
                  H·ªßy
                </button>
                <button class="btn-primary" [disabled]="!isProfileFormValid() || isSaving" (click)="saveProfile()">
                  {{ isSaving ? 'ƒêang l∆∞u...' : 'L∆∞u' }}
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Security Tab -->
      <div *ngIf="activeTab === 'security'" class="security-tab">
        <!-- Two-Factor Authentication -->
        <div class="security-section">
          <h3 class="section-title">X√°c Th·ª±c Hai Y·∫øu T·ªë (2FA)</h3>

          <div class="security-item">
            <div class="security-info">
              <div class="security-label">B·∫£o m·∫≠t n√¢ng cao</div>
              <div class="security-description">Th√™m l·ªõp b·∫£o m·∫≠t cho t√†i kho·∫£n c·ªßa b·∫°n</div>
            </div>
            <div class="security-control">
              <label class="toggle-switch">
                <input type="checkbox" [ngModel]="userSettings?.twoFactorEnabled"
                  (change)="toggleSetting('twoFactorEnabled')">
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>
        </div>

        <!-- Password Change -->
        <div class="security-section">
          <h3 class="section-title">ƒê·ªïi M·∫≠t Kh·∫©u</h3>

          <div class="password-form">
            <div class="form-group">
              <label>M·∫≠t kh·∫©u hi·ªán t·∫°i</label>
              <input type="password" [(ngModel)]="passwordForm.currentPassword" class="form-input"
                placeholder="Nh·∫≠p m·∫≠t kh·∫©u hi·ªán t·∫°i">
            </div>

            <div class="form-group">
              <label>M·∫≠t kh·∫©u m·ªõi</label>
              <input type="password" [(ngModel)]="passwordForm.newPassword" class="form-input"
                placeholder="Nh·∫≠p m·∫≠t kh·∫©u m·ªõi">
            </div>

            <div class="form-group">
              <label>X√°c nh·∫≠n m·∫≠t kh·∫©u m·ªõi</label>
              <input type="password" [(ngModel)]="passwordForm.confirmPassword" class="form-input"
                placeholder="Nh·∫≠p l·∫°i m·∫≠t kh·∫©u m·ªõi">
            </div>

            <div class="password-actions">
              <button class="btn-primary password-change-btn" [disabled]="!isPasswordFormValid() || isChangingPassword"
                [class.loading]="isChangingPassword" (click)="changePassword()">
                <span *ngIf="!isChangingPassword" class="btn-icon">üîê</span>
                <span *ngIf="isChangingPassword" class="btn-spinner">
                  <div class="spinner"></div>
                </span>
                <span class="btn-text">{{ isChangingPassword ? 'ƒêang thay ƒë·ªïi...' : 'ƒê·ªïi M·∫≠t Kh·∫©u' }}</span>
              </button>
            </div>
          </div>
        </div>

        <!-- Login Alerts -->
        <div class="security-section">
          <h3 class="section-title">C·∫£nh B√°o ƒêƒÉng Nh·∫≠p</h3>

          <div class="security-item">
            <div class="security-info">
              <div class="security-label">Th√¥ng b√°o ƒëƒÉng nh·∫≠p</div>
              <div class="security-description">Nh·∫≠n th√¥ng b√°o khi c√≥ ƒëƒÉng nh·∫≠p m·ªõi</div>
            </div>
            <div class="security-control">
              <label class="toggle-switch">
                <input type="checkbox" [ngModel]="userSettings?.loginNotificationEnabled"
                  (change)="toggleSetting('loginNotificationEnabled')">
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- Notifications Tab -->
      <div *ngIf="activeTab === 'notifications'" class="notifications-tab">
        <!-- Email Notifications -->
        <div class="notification-section">
          <h3 class="section-title">Th√¥ng B√°o Email</h3>

          <div class="notification-item">
            <div class="notification-info">
              <div class="notification-label">Email th√¥ng b√°o</div>
              <div class="notification-description">Th√¥ng b√°o v·ªÅ c√°c giao d·ªãch v√† ho·∫°t ƒë·ªông</div>
            </div>
            <div class="notification-control">
              <label class="toggle-switch">
                <input type="checkbox" [ngModel]="userSettings?.emailNotificationEnabled"
                  (change)="toggleSetting('emailNotificationEnabled')">
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>

          <div class="notification-item">
            <div class="notification-info">
              <div class="notification-label">Push th√¥ng b√°o</div>
              <div class="notification-description">Th√¥ng b√°o ƒë·∫©y tr√™n thi·∫øt b·ªã</div>
            </div>
            <div class="notification-control">
              <label class="toggle-switch">
                <input type="checkbox" [ngModel]="userSettings?.pushNotificationEnabled"
                  (change)="toggleSetting('pushNotificationEnabled')">
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>

          <!-- SMS th√¥ng b√°o ƒë√£ x√≥a v√¨ kh√¥ng c√≥ ti·ªÅn thu√™ d·ªãch v·ª• SMS -->
        </div>

        <!-- Privacy Settings -->
        <div class="notification-section">
          <h3 class="section-title">C√†i ƒê·∫∑t Ri√™ng T∆∞</h3>

          <!-- Profile c√¥ng khai ƒë√£ x√≥a v√¨ kh√¥ng c√≥ trang profile -->

          <div class="notification-item">
            <div class="notification-info">
              <div class="notification-label">Hi·ªÉn th·ªã tr·∫°ng th√°i online</div>
              <div class="notification-description">Cho ph√©p ng∆∞·ªùi kh√°c th·∫•y b·∫°n ƒëang online</div>
            </div>
            <div class="notification-control">
              <label class="toggle-switch">
                <input type="checkbox" [ngModel]="userSettings?.showOnlineStatus"
                  (change)="toggleSetting('showOnlineStatus')">
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>

          

          
        </div>
      </div>
    </div>

    <!-- Advanced Actions -->
    <div class="advanced-section">
      <h3 class="section-title">T√πy Ch·ªçn N√¢ng Cao</h3>

      <div class="advanced-actions">
        <button class="btn-secondary" (click)="exportSettings()">
          <span class="btn-icon">üì§</span>
          Xu·∫•t C√†i ƒê·∫∑t
        </button>

        <label class="btn-secondary file-input-label">
          <span class="btn-icon">üì•</span>
          Nh·∫≠p C√†i ƒê·∫∑t
          <input type="file" accept=".json" (change)="onFileChange($event)" hidden>
        </label>

        <button class="btn-warning" (click)="resetToDefaults()">
          <span class="btn-icon">üîÑ</span>
          Kh√¥i Ph·ª•c M·∫∑c ƒê·ªãnh
        </button>

        <!-- Profile data is now protected - no need for fix button -->
        <!-- X√≥a t√†i kho·∫£n button ƒë√£ b·ªã ·∫©n v√¨ qu√° r·ªßi ro -->
      </div>
    </div>
  </div>
</div>